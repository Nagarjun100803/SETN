{% extends "base.html" %}

{% block title %} Beneficiary Verify {% endblock %}

{% block content %}

    <div class="bg-slate-50 p-6 mt-20 rounded-lg">
        <!-- Profile Section -->
        <div class="flex flex-col items-center">
          <div class="relative w-40 h-40 lg:w-52 lg:h-52 mb-6">
            <img
              src="/admin_and_volunteer/beneficiary_profile_pic/{{ profile.id }}"
              alt="Profile Picture"
              class="w-[150px] h-[150px] lg:w-[200px] lg:h-[200px]  rounded-full shadow-lg border-2 border-white hover:shadow-2xl transition-all"
            />
          </div>
          <h1 class="text-2xl lg:text-3xl font-bold text-indigo-800">{{ profile.full_name }}</h1>
          <p class="text-md lg:text-lg text-center">{{ profile.course }} - {{ profile.department }}</p>
        </div>
      
        <!-- Details Section -->
        <div class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-6">
          <!-- Personal Details -->
          <div class="bg-white shadow-md hover:shadow-lg rounded-lg p-6 border-2 border-indigo-500">
            <h2 class="text-xl font-semibold text-emerald-700 mb-4">Personal Details</h2>
            <p class="font-bold"><span class="font-medium">Gender:</span> {{ profile.gender }}</p>
            <p class="font-bold"><span class="font-medium">Phone:</span> {{ profile.phone_num }}</p>
            <p class="font-bold"><span class="font-medium">Gheru Naav:</span> {{ profile.gheru_naav }}</p>
            <p class="font-bold"><span class="font-medium">Date of Birth:</span> {{ profile.date_of_birth }}</p>
            <p class="font-bold"><span class="font-medium">Gmail:</span> {{ profile.email_id }}</p>
            <p class="font-bold"><span class="font-medium">Status:</span> 
                  {% if profile.is_verified %}
                  <span class="text-green-400">Verified</span>
                  {% else %}
                  <span class="text-red-400">New</span>
                  {% endif %}
            </p>
          
          </div>
      
          <!-- Parental Details -->
          <div class="bg-white shadow-md hover:shadow-lg rounded-lg p-6 border-2  border-indigo-500">
            <h2 class="text-xl font-semibold text-emerald-700 mb-4">Parental Details</h2>
            <p class="font-bold"><span class="font-medium">Father's Name:</span> {{ profile.father_name }}</p>
            <p class="font-bold"><span class="font-medium">Father's Occupation:</span> {{ profile.father_occupation }}</p>
            <p class="font-bold"><span class="font-medium">Mother's Name:</span> {{ profile.mother_name }}</p>
            <p class="font-bold"><span class="font-medium">Mother's Occupation:</span> {{ profile.mother_occupation }}</p>
            <p class="font-bold"><span class="font-medium">Address:</span> {{ profile.address_line }}, {{ profile.city }}, {{ profile.district }} - {{ profile.pincode }}</p>
          </div>
      
          <!-- Educational Details -->
          <div class="bg-white shadow-md hover:shadow-lg rounded-lg p-6 border-2 border-indigo-500">
            <h2 class="text-xl font-semibold text-emerald-700 mb-4">Educational Details</h2>
            <p class="font-bold"><span class="font-medium">10th Percentage:</span> {{ profile.tenth_perc }}%</p>
            <p class="font-bold"><span class="font-medium">12th Percentage:</span> {{ profile.twelveth_perc }}%</p>
            <p class="font-bold"><span class="font-medium">College:</span> {{ profile.college_name }}</p>
            <p class="font-bold"><span class="font-medium">University:</span> {{ profile.university }}</p>
            <p class="font-bold"><span class="font-medium">Course:</span> {{ profile.course }} - {{ profile.degree }}</p>
          </div>
        </div>
      
        <!-- Marksheet Links -->
        <div class="mt-8 flex flex-col lg:flex-row gap-2 justify-center items-center">
          <a target="_blank" href="/admin_and_volunteer/beneficiary_marksheets/{{profile.id}}/?marksheet=tenth_marksheet" class="inline-block px-4 py-2 bg-indigo-500 text-white rounded-lg shadow-md hover:bg-indigo-600 hover:shadow-lg ">10th Marksheet</a>
          <a target="_blank" href="/admin_and_volunteer/beneficiary_marksheets/{{ profile.id }}/?marksheet=twelveth_marksheet"class="inline-block px-4 py-2 bg-indigo-500 text-white rounded-lg shadow-md hover:bg-indigo-600 hover:shadow-lg">12th Marksheet</a>
        </div>
      
        <!-- Remarks Form -->
        <div class="mt-12 bg-white shadow-md hover:shadow-lg rounded-lg p-6 ring-1 ring-emerald-400">
          <h2 class="text-xl font-semibold text-gray-950 mb-4">Add Remarks and Verify</h2>
          <form method="post" class="space-y-4" id="remarks-form">
              <textarea required id="remarks-field"  name="remarks" rows="4" placeholder="Enter your remarks here..."class="w-full p-3 border rounded-lg focus:outline-none focus:ring-1 focus:ring-indigo-500 shadow shadow-lg" ></textarea>

              {% if profile.edit_permission  %}
                <div class="flex justify-between gap-4">
                    {% if profile.is_verified %}
                    <button id="edit-button" type="button" class="px-6 py-2 bg-indigo-500 text-white rounded-lg hover:bg-emerald-600 shadow-md hover:shadow-lg">Edit</button>
                    {% endif %}
                    <button id="submit-button" type="submit" class="px-6 py-2 bg-indigo-500 text-white rounded-lg hover:bg-emerald-600 shadow-md hover:shadow-lg">Verify</button>
                
                  </div>
              {% else %}
                <p class="text-center font-bold text-lg lg:text-xl">You cannot edit or verify this Beneficiary.</p>
              {% endif %}
          </form>
        </div>
      </div>

      <script>
          
            const remarksField = document.getElementById("remarks-field");
            const submitButton = document.getElementById("submit-button");
            const editButton = document.getElementById("edit-button");
            
            // Jinja values
            const previousRemarks = "{{profile.remarks}}";
            const beneficiaryStatus = {{profile.is_verified | tojson}};
            const editPermission = {{profile.edit_permission | tojson }};
            
            if (editPermission === false){
              remarksField.disabled = true;
              editButton.disabled = true;
            }

            if (beneficiaryStatus == true){
              remarksField.disabled = true;
              submitButton.disabled = true;
              remarksField.value = previousRemarks || '';

            }


            editButton.addEventListener("click", () => {
              remarksField.disabled = false;
              submitButton.disabled = false;
              remarksField.focus() // return the focus to the end of the remarks field.

            });

          

          


      </script>
      
{% endblock %}
