{% extends "base.html" %}

{% block title %} Educational Details {% endblock %}

{% block content %}

    <div class="min-h-screen flex flex-col justify-center items-center m-5 mt-20">
        {% if filled %}
        <div>
            <p>Already filled your Education details</p>
        </div>
        {% else %}
 
        <div id="full-form" class="bg-white rounded-lg shadow-lg shadow-gray-900 lg:w-1/2 lg:rounded-2xl">
            
            <div id="form" class="font-mono italic flex flex-col gap-2 p-10">
                <div id="heading-div">
                    <!-- <h1 class="text-xl text-indigo-500 font-bold italic text-center sm:text-xl lg:text-2xl">Educational Details</h1> -->
                    <h1 class="text-xl text-gray-900 font-bold font-serif  text-center sm:text-xl lg:text-2xl">Educational Details</h1>
                    
                </div>
                
                <form method="post" enctype="multipart/form-data" class="grid grid-cols-1 mt-2 gap-2 sm:grid sm:grid-cols-2 sm:gap-3">

                    <div class="flex flex-col gap-0.5" id="tenth_perc-div">
                        <label for="tenth_perc">Tenth Percentage</label>
                        <input required type="number" name="tenth_perc" min="50" max="100" step="0.01" oninput="validateRange(this)" placeholder="76.90" id="tenth_perc" pattern="" 
                            class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                    </div>

                    <div class="flex flex-col gap-0.5" id="eleventh_perc-div">
                        <label for="eleventh_perc">Eleventh Percentage</label>
                        <input required type="number" name="eleventh_perc"  min="50" max="100" step="0.01" oninput="validateRange(this)" placeholder="72.98" id="eleventh_perc" pattern="d{2}.d{2}" 
                            class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                    </div>

                    <div class="flex flex-col gap-0.5" id="twelveth_perc-div">
                        <label for="twelveth_perc">Twelveth Percentage</label>
                        <input required type="number"  min="50" max="100" step="0.01" oninput="validateRange(this)" placeholder="89.22" name="twelveth_perc" id="twelveth_perc" pattern="d{2}.d{2}" 
                            class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md ">
                    </div>
                    
                    <div class="flex flex-col gap-0.5" id="course-div">
                        <label for="course" class="text-md">Course</label>
                        <select name="course" id="course" class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                            <option value="">Select a Course</option>
                        </select>
                    </div>
                    
                    <div class="flex flex-col gap-0.5" id="degree-div">
                        <label for="degree">Degree</label>
                        <select name="degree" id="degree" class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                            <option value="">Select a Degree</option>
                        </select>
                    </div>

                    <div class="flex flex-col gap-0.5" id="department-div">
                        <label for="department">Department</label>
                        <select name="department" id="department" class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                            <option value="">Select a Department</option>
                        </select>
                    </div>

                    <div class="flex flex-col gap-0.5" id="college_name-div">
                        <label for="college_name">College Name</label>
                        <input required type="text" name="college_name" id="college_name" placeholder="Saurashstra College of Engineering" 
                            class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                    </div>

                    <div class="flex flex-col gap-0.5" id="college_type-div">
                        <label for="college_type">College Type</label>
                        <select name="college_type" id="college_type" class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                            <option value="Affiliated">Affiliated</option>
                            <option value="Autonomous">Autonomous</option>
                        </select>
                    </div>

                    <div class="flex flex-col gap-0.5" id="university-div">
                        <label for="university">University Name</label>
                        <input required type="text" name="university" id="pincode" placeholder="Anna University" 
                            class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                    </div>
    
                    <div class="flex flex-col gap-0.5" id="college_address-div">
                        <label for="college_address">College Address</label>
                        <input required type="text" name="college_address" id="pincode" placeholder="No.3 Madurai Main Road" 
                            class="rounded-lg border-2 border-indigo-500 focus:ring-2 focus:ring-indigo-600  focus:shadow-gray-900 focus:shadow-md">
                    </div>

                    <!-- File uploads -->

                    <div class="flex flex-col gap-2" id="tenth_marksheet-div">
                        <label for="tenth_marksheet">Tenth Marksheet</label>
                        <input required type="file" name="tenth_marksheet" id="tenth_marksheet" accept=".pdf" class="">
                    </div>

                    <div class="flex flex-col gap-2" id="eleventh_marksheet-div">
                        <label for="eleventh_marksheet">Eleventh Marksheet</label>
                        <input required type="file" name="eleventh_marksheet" id="eleventh_marksheet" accept=".pdf" class="">
                    </div>

                    <div class="flex flex-col gap-2 mt-2" id="tenth_marksheet-div">
                        <label for="twelveth_marksheet">Twelveth Marksheet</label>
                        <input required type="file" name="twelveth_marksheet" id="twelveth_marksheet" accept=".pdf" class="">
                    </div>
                    
                    <div class="flex flex-col mt-3 text-center">
                        <span class="text-red-600"><span class="text-lg font-bold underline">Note:</span> Make sure to fill the details as by marksheets.</span>
                    </div>

                    <div class="flex flex-col mt-3 sm:mt-4 sm:col-span-2">
                        <button class=" bg-indigo-500 text-white rounded-lg px-14 py-3" type="submit">Submit</button>
                    </div>

                </form>

        </div>
    </div>


    <script>
        // Assigning the `course` variable from Jinja to JavaScript
        const courseData = {{ course|tojson }};
        
        // Dropdown references
        const courseDropdown = document.getElementById("course");
        const degreeDropdown = document.getElementById("degree");
        const departmentDropdown = document.getElementById("department");
    
        // Populate the course dropdown on page load
        document.addEventListener("DOMContentLoaded", () => {
          Object.keys(courseData).forEach(course => {
            const option = document.createElement("option");
            option.value = course;
            option.textContent = course;
            courseDropdown.appendChild(option);
          });
        });
    
        // Update the degree dropdown when a course is selected
        courseDropdown.addEventListener("change", () => {
          const selectedCourse = courseDropdown.value;
    
          // Clear existing options
          degreeDropdown.innerHTML = "<option value=''>Select a Degree</option>";
          departmentDropdown.innerHTML = "<option value=''>Select a Department</option>";
    
          if (selectedCourse) {
            const degrees = Object.keys(courseData[selectedCourse]);
            degrees.forEach(degree => {
              const option = document.createElement("option");
              option.value = degree;
              option.textContent = degree;
              degreeDropdown.appendChild(option);
            });
          }
        });
    
        // Update the department dropdown when a degree is selected
        degreeDropdown.addEventListener("change", () => {
          const selectedCourse = courseDropdown.value;
          const selectedDegree = degreeDropdown.value;
    
          // Clear existing options
          departmentDropdown.innerHTML = "<option value=''>Select a Department</option>";
    
          if (selectedCourse && selectedDegree) {
            const departments = courseData[selectedCourse][selectedDegree];
            departments.forEach(department => {
              const option = document.createElement("option");
              option.value = department;
              option.textContent = department;
              departmentDropdown.appendChild(option);
            });
          }
        });
      </script>
      {% endif %}
{% endblock %}